(()=>{var t={n:n=>{var o=n&&n.__esModule?()=>n.default:()=>n;return t.d(o,{a:o}),o},d:(n,o)=>{for(var a in o)t.o(o,a)&&!t.o(n,a)&&Object.defineProperty(n,a,{enumerable:!0,get:o[a]})},o:(t,n)=>Object.prototype.hasOwnProperty.call(t,n),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},n={};(()=>{"use strict";t.r(n);const o=flarum.core.compat["admin/app"];var a=t.n(o);function e(t,n){return e=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t},e(t,n)}function r(t,n){t.prototype=Object.create(n.prototype),t.prototype.constructor=t,e(t,n)}const i=flarum.core.compat["common/Model"];var s=t.n(i),u=function(t){function n(){for(var n,o=arguments.length,a=new Array(o),e=0;e<o;e++)a[e]=arguments[e];return(n=t.call.apply(t,[this].concat(a))||this).code=s().attribute("code"),n.hasUsagesLeft=s().attribute("hasUsagesLeft"),n.canUse=s().attribute("canUse"),n.usageCount=s().attribute("usageCount"),n.maxUsage=s().attribute("maxUsage"),n.createdAt=s().attribute("createdAt",s().transformDate),n.group=s().hasOne("group"),n}return r(n,t),n.prototype.apiEndpoint=function(){return"/group-invitations"+(this.exists?"/"+this.data.id:"")},n}(s());const c=flarum.core.compat["common/components/Button"];var l=t.n(c);const p=flarum.core.compat["common/components/GroupBadge"];var d=t.n(p);const g=flarum.core.compat["common/components/LoadingIndicator"];var f=t.n(g);const v=flarum.core.compat["admin/components/ExtensionPage"];var h=t.n(v);const w=flarum.core.compat["common/models/Group"];var b=t.n(w);const y=flarum.core.compat["common/helpers/icon"];var I=t.n(y),U=function(){function t(){}return t.prototype.view=function(t){var n=t.attrs,o=n.onchange,e=n.value;return m("span.Select",[m("select.Select-input.FormControl",{onchange:function(t){o(t.target.value)},value:e},[m("option",{value:"",disabled:!0,hidden:!0},a().translator.trans("clarkwinkelmann-group-invitation.admin.settings.placeholder.group")),a().store.all("groups").filter((function(t){return-1===[b().GUEST_ID,b().MEMBER_ID].indexOf(t.id())})).map((function(t){return m("option",{value:t.id()},t.namePlural())}))]),I()("fas fa-sort",{className:"Select-caret"})])},t}(),x="clarkwinkelmann-group-invitation.admin.settings.",k=function(t){function n(){for(var n,o=arguments.length,a=new Array(o),e=0;e<o;e++)a[e]=arguments[e];return(n=t.call.apply(t,[this].concat(a))||this).invitations=null,n.newInvitationGroupId="",n.newInvitationMaxUsage="",n}r(n,t);var o=n.prototype;return o.oninit=function(n){var o=this;t.prototype.oninit.call(this,n),a().store.find("group-invitations",{}).then((function(t){o.invitations=t,m.redraw()})),this.loading=!1},o.content=function(){var t=this;return m(".ExtensionPage-settings.GroupInvitationSettingsPage",m(".container",[m("table",[m("thead",m("tr",[m("th",a().translator.trans(x+"head.code")),m("th",a().translator.trans(x+"head.group")),m("th",a().translator.trans(x+"head.usage")),m("th")])),m("tbody",[null===this.invitations?m("tr",m("td",f().component())):[this.invitations.map((function(n,o){var e=n.group();return m("tr",[m("td",m("a",{href:a().forum.attribute("baseUrl")+"/get-role/"+n.code(),target:"_blank"},m("code",n.code()))),m("td",[d().component({group:e})," ",e&&e.namePlural()]),m("td",n.usageCount()+"/"+(null===n.maxUsage()?a().translator.trans(x+"unlimited"):n.maxUsage())),m("td",l().component({className:"Button Button--danger",onclick:function(){t.loading=!0,n.delete().then((function(){t.loading=!1,t.invitations.splice(o,1),m.redraw()})).catch((function(n){throw t.loading=!1,m.redraw(),n}))},loading:t.loading},a().translator.trans(x+"delete")))])})),0===this.invitations.length?m("tr.NoResultRow",m("td",{colspan:4},m("em",a().translator.trans(x+"empty")))):null],m("tr",[m("td",m("em",a().translator.trans(x+"placeholder.code"))),m("td",m(U,{onchange:function(n){t.newInvitationGroupId=n},value:this.newInvitationGroupId})),m("td",m("input.FormControl",{type:"number",min:"0",onchange:function(n){var o=n.target.value;t.newInvitationMaxUsage="0"===o?"":o},value:this.newInvitationMaxUsage,placeholder:a().translator.trans(x+"placeholder.usage")})),m("td",l().component({className:"Button Button--primary",onclick:function(){t.loading=!0,a().request({method:"POST",url:a().forum.attribute("apiUrl")+"/group-invitations",body:{groupId:t.newInvitationGroupId,maxUsage:t.newInvitationMaxUsage}}).then((function(n){t.loading=!1,t.invitations.push(a().store.pushPayload(n)),t.newInvitationGroupId="",t.newInvitationMaxUsage="",m.redraw()})).catch((function(n){throw t.loading=!1,m.redraw(),n}))},loading:this.loading,disabled:!this.newInvitationGroupId},a().translator.trans(x+"create")))])])])]))},n}(h());a().initializers.add("clarkwinkelmann-group-invitation",(function(){a().store.models["group-invitations"]=u,a().extensionData.for("clarkwinkelmann-group-invitation").registerPage(k).registerPermission({icon:"fas fa-certificate",label:a().translator.trans("clarkwinkelmann-group-invitation.admin.permissions.use"),permission:"clarkwinkelmann-group-invitation.use"},"start")}))})(),module.exports=n})();
//# sourceMappingURL=admin.js.map