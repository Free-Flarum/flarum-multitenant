module.exports=function(t){var e={};function n(s){if(e[s])return e[s].exports;var o=e[s]={i:s,l:!1,exports:{}};return t[s].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,s){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(s,o,function(e){return t[e]}.bind(null,o));return s},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=21)}([function(t,e){t.exports=flarum.core.compat.extend},function(t,e){t.exports=flarum.core.compat.Model},function(t,e){t.exports=flarum.core.compat.app},function(t,e,n){"use strict";function s(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}n.d(e,"a",(function(){return s}))},,function(t,e){t.exports=flarum.core.compat["components/Button"]},function(t,e){t.exports=flarum.core.compat["models/Discussion"]},,function(t,e){t.exports=flarum.core.compat["states/DiscussionListState"]},function(t,e){t.exports=flarum.core.compat["components/DiscussionListItem"]},function(t,e){t.exports=flarum.core.compat["components/DiscussionList"]},function(t,e){t.exports=flarum.core.compat["components/DiscussionPage"]},function(t,e){t.exports=flarum.core.compat["components/FieldSet"]},function(t,e){t.exports=flarum.core.compat["utils/abbreviateNumber"]},function(t,e){t.exports=flarum.core.compat["helpers/avatar"]},function(t,e){t.exports=flarum.core.compat["utils/ItemList"]},function(t,e){t.exports=flarum.core.compat["utils/string"]},function(t,e){t.exports=flarum.core.compat["utils/humanTime"]},function(t,e){t.exports=flarum.core.compat["utils/DiscussionControls"]},function(t,e){t.exports=flarum.core.compat["components/Modal"]},,function(t,e,n){"use strict";n.r(e);var s=n(2),o=n.n(s),i=n(0),r=n(8),a=n.n(r),u=n(1),c=n.n(u),l=n(6),p=n.n(l),f=n(9),d=n.n(f),b=n(10),v=n.n(b),h=n(11),w=n.n(h),y=n(12),x=n.n(y),_=n(13),g=n.n(_);function O(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var j=n(3);function C(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var D=function(t){function e(){for(var e,n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return C(O(e=t.call.apply(t,[this].concat(s))||this),"visitedAt",c.a.attribute("visited_at",c.a.transformDate)),C(O(e),"user",c.a.hasOne("user")),C(O(e),"discussion",c.a.hasOne("discussion")),e}return Object(j.a)(e,t),e}(c.a),M=n(14),N=n.n(M),P=n(15),S=n.n(P),V=n(16),L=n(17),A=n.n(L),B=n(5),F=n.n(B),I=n(18),R=n.n(I),U=n(19),T=function(t){function e(){return t.apply(this,arguments)||this}Object(j.a)(e,t);var n=e.prototype;return n.oninit=function(e){t.prototype.oninit.call(this,e),this.discussion=this.attrs.discussion,this.currentViewsCount=this.discussion.viewCount()},n.content=function(){return m("div",{className:"Modal-body"},m("div",{className:"Form Form--centered"},m("p",null,app.translator.transChoice("michaelbelgium-discussion-views.forum.modal_resetviews.label",this.currentViewsCount,{count:this.currentViewsCount})),m("div",{className:"Form-group"},F.a.component({className:"Button Button--primary Button--block",type:"submit",loading:this.loading},app.translator.trans("michaelbelgium-discussion-views.forum.modal_resetviews.submit_button")))))},n.title=function(){return app.translator.trans("michaelbelgium-discussion-views.forum.modal_resetviews.title")},n.className=function(){return"Modal--small"},n.onsubmit=function(t){var e=this;t.preventDefault(),this.loading=!0,this.attrs.discussion.save({resetViews:!0}).catch((function(){e.loaded()})),this.hide()},e}(n.n(U).a);o.a.initializers.add("michaelbelgium-discussion-views",(function(){Object(i.extend)(a.a.prototype,"sortMap",(function(t){1==app.forum.attribute("mb-discussionviews.show_filter")&&(t.popular="-view_count",t.unpopular="view_count")})),app.store.models.discussionviews=D,p.a.prototype.views=c.a.hasMany("latestViews"),p.a.prototype.canReset=c.a.attribute("canReset"),p.a.prototype.viewCount=c.a.attribute("viewCount"),Object(i.extend)(d.a.prototype,"infoItems",(function(t){if(this.attrs.discussion.attribute("canViewNumber")){var e=this.attrs.discussion.viewCount(),n=1==app.forum.attribute("mb-discussionviews.abbr_numbers")?g()(e):e;t.add("discussion-views",m("span",null,n))}})),Object(i.extend)(v.a.prototype,"requestParams",(function(t){t.include.push("latestViews")})),Object(i.extend)(w.a.prototype,"sidebarItems",(function(t){if(0!=app.forum.attribute("mb-discussionviews.show_viewlist")){var e=this.discussion.views(),n=new S.a;$.each(e,(function(t,e){var s=!1===e.user()?"Guest":Object(V.ucfirst)(e.user().username()),o=m("div",{className:"item-lastUser-content"},N()(e.user()),m("div",null,s,m("span",{className:"lastUser-visited",title:e.visitedAt().toLocaleString()},A()(e.visitedAt()))));!1!==e.user()&&(o=m("a",{href:app.route.user(e.user())},o)),n.add("lastUser-"+t,o)})),t.add("lastDiscussionViewers",m(x.a,{className:"LastDiscussionUsers",label:app.translator.trans("michaelbelgium-discussion-views.forum.viewlist.title")},n.toArray()))}})),Object(i.extend)(R.a,"moderationControls",(function(t,e){e.attribute("canReset")&&e.viewCount()>0&&t.add("reset",m(F.a,{icon:"far fa-eye-slash",onclick:function(){return app.modal.show(T,{discussion:e})}},app.translator.trans("michaelbelgium-discussion-views.forum.discussion_controls.resetviews_button")))}))}))}]);
//# sourceMappingURL=forum.js.map